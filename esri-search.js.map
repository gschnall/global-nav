{"version":3,"file":"esri-search.js","sources":["node_modules/domose/domose.js","search.js"],"sourcesContent":["/* Speculative DOM Functionality\n/* ========================================================================== */\n\nfunction __assignSource(element, source, prefix) {\n\tfor (let key in source) {\n\t\tif ('function' === typeof source[key]) {\n\t\t\t// add functions as event listeners\n\t\t\telement.addEventListener(prefix + key, source[key]);\n\t\t} else if (Object(source[key]) === source[key]) {\n\t\t\t// assign objects as source\n\t\t\t__assignSource(element, source[key], `${prefix + key}-`);\n\t\t} else {\n\t\t\t// otherwise, set attributes\n\t\t\telement.setAttribute(prefix + key, source[key]);\n\t\t}\n\t}\n}\n\n/* Assign an element with attributes, events, and children\n/* ========================================================================== */\n\nfunction $assign(id) {\n\t// $assign(element, { class: 'btn', click: () => { /* listener */ } });\n\t// $assign('button', { aria: { label: 'title' } }, child);\n\t// $assign('div', child1, child2, 'a new text node');\n\t// $assign(document.createElementNS('http://www.w3.org/2000/svg', 'svg'));\n\n\tconst element = id instanceof Node ? id : document.createElement(id);\n\n\t[].slice.call(arguments, 1).forEach((source) => {\n\t\tif (source instanceof Node) {\n\t\t\t// append sources that are nodes\n\t\t\telement.appendChild(source);\n\t\t} else if ('string' === typeof source) {\n\t\t\t// append strings as text nodes\n\t\t\telement.appendChild(\n\t\t\t\tdocument.createTextNode(source)\n\t\t\t);\n\t\t} else {\n\t\t\t__assignSource(element, source, '');\n\t\t}\n\t});\n\n\treturn element;\n}\n\n/* Replace all the children of a parent node with new children\n/* ========================================================================== */\n\nfunction $replaceAll(parentNode) {\n\t// $replaceAll(element);\n\t// $replaceAll(element, child1, child2);\n\n\twhile (parentNode.lastChild) {\n\t\tparentNode.removeChild(parentNode.lastChild);\n\t}\n\n\tparentNode.appendChild(\n\t\t__asFragment(arguments)\n\t);\n\n\treturn parentNode;\n}\n\n/* Wrap a child node within an element\n/* ========================================================================== */\n\nfunction $wrapWith(childNode, element) {\n\t// $wrapWith(element, wrappingElement);\n\n\tif (childNode.parentNode) {\n\t\tchildNode.parentNode.insertBefore(element, childNode).appendChild(childNode);\n\t}\n\n\treturn childNode;\n}\n\n/* Emerging DOM Functionality\n/* ========================================================================== */\n\nfunction __asFragment(nodes) {\n\tconst fragment = document.createDocumentFragment();\n\n\t[].slice.call(nodes, 1).forEach((node) => {\n\t\tif (node instanceof Node) {\n\t\t\tfragment.appendChild(node);\n\t\t} else {\n\t\t\tfragment.appendChild(\n\t\t\t\tdocument.createTextNode(node)\n\t\t\t);\n\t\t}\n\t});\n\n\treturn fragment;\n}\n\n/* Insert nodes after a child node\n/* ========================================================================== */\n\nfunction $after(childNode) {\n\t// $after(element, sibling1, sibling2, 'a new text node');\n\n\tif (childNode.parentNode) {\n\t\tchildNode.parentNode.insertBefore(\n\t\t\t__asFragment(arguments),\n\t\t\tchildNode.nextSibling\n\t\t);\n\t}\n\n\treturn childNode;\n}\n\n/* Appends nodes to a parent node\n/* ========================================================================== */\n\nfunction $append(parentNode) {\n\t// $append(parentNode, child1, child2, 'a new text node');\n\n\tparentNode.append(\n\t\t__asFragment(arguments)\n\t);\n\n\treturn parentNode;\n}\n\n/* Insert nodes before an element\n/* ========================================================================== */\n\nfunction $before(element) {\n\t// $before(element, sibling1, sibling2, 'a new text node');\n\n\tif (element.parentNode) {\n\t\telement.parentNode.insertBefore(\n\t\t\t__asFragment(arguments),\n\t\t\telement\n\t\t);\n\t}\n\n\treturn element;\n}\n\n/* Return the closest ancestor element matching a given selector\n/* ========================================================================== */\n\nfunction $closest(element, selectors) {\n\t// $closest(element, selectors);\n\n\tlet target = element;\n\n\twhile (target && 1 === target.nodeType) {\n\t\tif ($matches(target, selectors)) {\n\t\t\treturn target;\n\t\t}\n\n\t\ttarget = target.parentNode;\n\t}\n\n\treturn null;\n}\n\n/* Return whether or not a DOM element matches a given selector\n/* ========================================================================== */\n\nfunction $matches(element, selectors) {\n\t// $matches(element, selectors);\n\n\tconst elements = element.parentNode.querySelectorAll(selectors);\n\n\tlet index = 0;\n\n\twhile (elements[index] && elements[index] !== element) {\n\t\t++index;\n\t}\n\n\treturn Boolean(elements[index]);\n}\n\n/* Prepends a child to a parent node\n/* ========================================================================== */\n\nfunction $prepend(parentNode) {\n\t// $prepend(element, child1, child2, 'a new text node');\n\n\tparentNode.insertBefore(\n\t\t__asFragment(arguments),\n\t\tparentNode.firstChild\n\t);\n\n\treturn parentNode;\n}\n\n/* Remove a child node from its parent\n/* ========================================================================== */\n\nfunction $remove(childNode) {\n\t// $remove(element);\n\n\tif (childNode.parentNode) {\n\t\tchildNode.parentNode.removeChild(childNode);\n\t}\n\n\treturn childNode;\n}\n\n/* Replace a child node with nodes\n/* ========================================================================== */\n\nfunction $replaceWith(childNode) {\n\t// $replaceWith(element, sibling1, sibling2, 'a new text node');\n\n\tif (childNode.parentNode) {\n\t\tchildNode.parentNode.replaceChild(\n\t\t\t__asFragment(arguments),\n\t\t\tchildNode\n\t\t);\n\t}\n\n\treturn childNode;\n}\n\n/* Emerging Event Functionality\n/* ========================================================================== */\n\n/* Create a new CustomEvent\n/* ========================================================================== */\n\nfunction $CustomEvent(type) {\n\t// element.dispatchEvent(new $CustomEvent('click', { bubbles: true }));\n\n\tconst event = document.createEvent('CustomEvent');\n\tconst param = Object(arguments[1]) || { bubbles: false, cancelable: false, detail: undefined };\n\n\tevent.initCustomEvent(type, param.bubbles, param.cancelable, param.detail);\n\n\treturn event;\n}\n\n/* Fetch response text from a URL and pass it to a callback\n/* ========================================================================== */\n\nfunction $fetch(url, callback) {\n\t// $fetch('api?foo=bar', (responseText) => {});\n\n\tconst xhr = new XMLHttpRequest();\n\n\txhr.addEventListener('readystatechange', () => {\n\t\tif (4 === xhr.readyState && 200 === xhr.status) {\n\t\t\tcallback(xhr.responseText); // eslint-disable-line callback-return\n\t\t}\n\t});\n\n\txhr.open('GET', url);\n\txhr.send();\n\n\treturn xhr;\n}\n\n/* Export\n/* ========================================================================== */\n\nexport {\n\t$assign,\n\t$after,\n\t$append,\n\t$before,\n\t$closest,\n\t$CustomEvent,\n\t$fetch,\n\t$matches,\n\t$prepend,\n\t$remove,\n\t$replaceAll,\n\t$replaceWith,\n\t$wrapWith\n};\n","/* Esri Search Form, Copyright 2017 Esri\n\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed\nunder the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\nCONDITIONS OF ANY KIND, either express or implied.\n\nSee the License for the specific language governing permissions and limitations\nunder the License. */\n\nimport { $assign as $, $CustomEvent } from 'domose';\n\n/* Search\n/* ========================================================================== */\n\nexport default (data) => {\n\t/* Elements\n\t/* ====================================================================== */\n\n\tconst $label = $('label', {\n\t\tclass: `${data.prefix}-label`,\n\t\tfor: `${data.prefix}-query-control`\n\t}, data.queryLabel);\n\n\tconst $control = $('input', {\n\t\tclass: `${data.prefix}-control`, id: `${data.prefix}-control`,\n\t\ttype: 'search', name: 'q',\n\t\tautocapitalize: 'off', autocomplete: 'off', autocorrect: 'off', spellcheck: 'false'\n\t});\n\n\tconst $measureTextNode = document.createTextNode('');\n\n\tconst $measureText = $('div', {\n\t\tclass: `${data.prefix}-measure-text`,\n\t\taria: { hidden: true }\n\t}, $measureTextNode);\n\n\tconst $measure = $('div', { class: `${data.prefix}-measure` }, $measureText);\n\n\tconst $submit = $('button', {\n\t\tclass: `${data.prefix}-submit`, type: 'submit',\n\t\taria: { label: data.submitLabel }\n\t});\n\n\tconst $search = $('form', {\n\t\tclass: `${data.prefix}-form`, action: data.action,\n\t\trole: 'search', aria: { label: data.label }\n\t}, $label, $control, $measure, $submit);\n\n\t/* Focus Event\n\t/* ====================================================================== */\n\n\t$search.addEventListener(`${data.prefix}:focus`, () => {\n\t\t$control.focus();\n\t});\n\n\t/* On Input\n\t/* ====================================================================== */\n\n\tlet controlIsFilled = false;\n\tlet controlValue = '';\n\n\tfunction oninput(event) {\n\t\t/* Conditionally Reset Control Value\n\t\t/* ================================================================== */\n\n\t\tif (event && 'reset' === event.type) {\n\t\t\t$control.value = '';\n\t\t}\n\n\t\t/* Update New Control Value\n\t\t/* ================================================================== */\n\n\t\tconst newControlValue = $control.value.trim();\n\n\t\tif (newControlValue !== controlValue) {\n\t\t\tcontrolValue = newControlValue;\n\n\t\t\t$dispatch($search, `${data.prefix}:input`, {\n\t\t\t\tvalue: controlValue,\n\t\t\t\tevent\n\t\t\t});\n\t\t}\n\n\t\t/* Update Label and Submit UI\n\t\t/* ================================================================== */\n\n\t\tif (controlIsFilled && !newControlValue) {\n\t\t\tcontrolIsFilled = false;\n\n\t\t\t$label.removeAttribute('data-filled');\n\t\t\t$submit.removeAttribute('data-filled');\n\t\t} else if (!controlIsFilled && newControlValue) {\n\t\t\tcontrolIsFilled = true;\n\n\t\t\t$($label, { data: { filled: '' } });\n\t\t\t$($submit, { data: { filled: '' } });\n\t\t}\n\n\t\t/* Update Measure UI\n\t\t/* ================================================================== */\n\n\t\t$measureTextNode.nodeValue = newControlValue;\n\n\t\tconst currentWidth = `${$measureText.scrollWidth}px`;\n\n\t\t$measure.style.width = currentWidth;\n\t}\n\n\t/* On Submit\n\t/* ====================================================================== */\n\n\tfunction onsubmit(event) {\n\t\t$dispatch($search, `${data.prefix}:submit`, {\n\t\t\tvalue: $control.value,\n\t\t\tevent\n\t\t});\n\t}\n\n\t/* On DOMNodeInserted\n\t/* ====================================================================== */\n\n\t$search.addEventListener('DOMNodeInserted', function onDOMNodeInserted() {\n\t\t// If Search now has a parent node\n\t\tif ($search.parentNode) {\n\t\t\t// Unbind the DOMNodeInserted method\n\t\t\t$search.removeEventListener('DOMNodeInserted', onDOMNodeInserted);\n\n\t\t\t// Update Search\n\t\t\t$dispatch($search, `${data.prefix}:update`, data);\n\t\t}\n\t});\n\n\t/* On Update\n\t/* ====================================================================== */\n\n\t$search.addEventListener(`${data.prefix}:update`, () => {\n\t\t/* Bind Media Event\n\t\t/* ====================================================================== */\n\n\t\tconst media = $search.ownerDocument.defaultView.matchMedia(data.matchMedia || '(max-width: 720px)');\n\n\t\tmedia.addListener(oninput);\n\n\t\t/* Bind Other Events\n\t\t/* ================================================================== */\n\n\t\t$control.addEventListener('input', oninput);\n\n\t\t$search.addEventListener('reset', oninput);\n\t\t$search.addEventListener('submit', onsubmit);\n\t\t$search.addEventListener(`${data.prefix}:unload`, onunload);\n\t});\n\n\treturn $search;\n};\n\n/* Dispatch Helper\n/* ========================================================================== */\n\nfunction $dispatch(target, type, detail) {\n\ttarget.dispatchEvent($CustomEvent(type, { bubbles: true, detail }));\n}\n"],"names":["__assignSource","element","source","prefix","key","addEventListener","Object","setAttribute","$assign","id","Node","document","createElement","slice","call","arguments","forEach","appendChild","createTextNode","$CustomEvent","type","event","createEvent","param","bubbles","cancelable","detail","undefined","initCustomEvent","$dispatch","target","dispatchEvent","data","oninput","value","newControlValue","$control","trim","controlValue","$search","controlIsFilled","removeAttribute","$label","filled","$submit","nodeValue","currentWidth","$measureText","scrollWidth","style","width","onsubmit","$","queryLabel","name","autocomplete","autocorrect","spellcheck","$measureTextNode","hidden","$measure","class","label","submitLabel","action","aria","focus","onDOMNodeInserted","parentNode","removeEventListener","ownerDocument","defaultView","matchMedia","addListener","onunload"],"mappings":"uCAGA,SAASA,EAAeC,EAASC,EAAQC,OACnC,IAAIC,KAAOF,EACX,mBAAsBA,EAAOE,KAExBC,iBAAiBF,EAASC,EAAKF,EAAOE,IACpCE,OAAOJ,EAAOE,MAAUF,EAAOE,KAE1BH,EAASC,EAAOE,GAASD,EAASC,SAGzCG,aAAaJ,EAASC,EAAKF,EAAOE,IAQ7C,SAASI,EAAQC,OAMVR,EAAUQ,aAAcC,KAAOD,EAAKE,SAASC,cAAcH,YAE9DI,MAAMC,KAAKC,UAAW,GAAGC,QAAQ,SAACd,GAChCA,aAAkBQ,OAEbO,YAAYf,GACV,iBAAoBA,IAEtBe,YACPN,SAASO,eAAehB,MAGVD,EAASC,EAAQ,MAI3BD,EAuLR,SAASkB,EAAaC,OAGfC,EAAQV,SAASW,YAAY,eAC7BC,EAAQjB,OAAOS,UAAU,MAASS,SAAS,EAAOC,YAAY,EAAOC,YAAQC,YAE7EC,gBAAgBR,EAAMG,EAAMC,QAASD,EAAME,WAAYF,EAAMG,QAE5DL,ECvER,SAASQ,EAAUC,EAAQV,EAAMM,KACzBK,cAAcZ,EAAaC,GAAQI,SAAS,EAAME,4BAlJ1CM,YA+CNC,EAAQZ,GAIZA,GAAS,UAAYA,EAAMD,SACrBc,MAAQ,QAMZC,EAAkBC,EAASF,MAAMG,OAEnCF,IAAoBG,MACRH,IAELI,EAAYP,EAAK7B,uBACnBmC,aAQLE,IAAoBL,MACL,IAEXM,gBAAgB,iBACfA,gBAAgB,iBACbD,GAAmBL,OACZ,IAEhBO,GAAUV,MAAQW,OAAQ,QAC1BC,GAAWZ,MAAQW,OAAQ,SAMbE,UAAYV,MAEvBW,EAAkBC,EAAaC,mBAE5BC,MAAMC,MAAQJ,WAMfK,EAAS9B,KACPkB,EAAYP,EAAK7B,wBACnBiC,EAASF,oBA/FZQ,EAASU,EAAE,eACNpB,EAAK7B,oBACP6B,EAAK7B,yBACX6B,EAAKqB,YAEFjB,EAAWgB,EAAE,eACRpB,EAAK7B,kBAAkBM,GAAOuB,EAAK7B,uBACvC,SAAUmD,KAAM,mBACN,MAAOC,aAAc,MAAOC,YAAa,MAAOC,WAAY,UAGvEC,EAAmB/C,SAASO,eAAe,IAE3C6B,EAAeK,EAAE,aACZpB,EAAK7B,6BACPwD,QAAQ,IACdD,GAEGE,EAAWR,EAAE,OAASS,MAAU7B,EAAK7B,mBAAoB4C,GAEzDH,EAAUQ,EAAE,gBACPpB,EAAK7B,iBAAiBiB,KAAM,eAC9B0C,MAAO9B,EAAK+B,eAGfxB,EAAUa,EAAE,cACPpB,EAAK7B,eAAe6D,OAAQhC,EAAKgC,YACrC,SAAUC,MAAQH,MAAO9B,EAAK8B,QAClCpB,EAAQN,EAAUwB,EAAUhB,KAKvBvC,iBAAoB2B,EAAK7B,gBAAgB,aACvC+D,cAMN1B,GAAkB,EAClBF,EAAe,YA8DXjC,iBAAiB,kBAAmB,SAAS8D,IAEhD5B,EAAQ6B,eAEHC,oBAAoB,kBAAmBF,KAGrC5B,EAAYP,EAAK7B,iBAAiB6B,QAOtC3B,iBAAoB2B,EAAK7B,iBAAiB,WAInCoC,EAAQ+B,cAAcC,YAAYC,WAAWxC,EAAKwC,YAAc,sBAExEC,YAAYxC,KAKT5B,iBAAiB,QAAS4B,KAE3B5B,iBAAiB,QAAS4B,KAC1B5B,iBAAiB,SAAU8C,KAC3B9C,iBAAoB2B,EAAK7B,iBAAiBuE,YAG5CnC","preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb25hdGhhbm5lYWwvR2l0SHViL0FyY0dJUy9lc3JpLWdsb2JhbC1uYXYvc2VhcmNoL25vZGVfbW9kdWxlcy9kb21vc2UvZG9tb3NlLmpzIiwiL1VzZXJzL2pvbmF0aGFubmVhbC9HaXRIdWIvQXJjR0lTL2VzcmktZ2xvYmFsLW5hdi9zZWFyY2gvc2VhcmNoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIFNwZWN1bGF0aXZlIERPTSBGdW5jdGlvbmFsaXR5XG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiBfX2Fzc2lnblNvdXJjZShlbGVtZW50LCBzb3VyY2UsIHByZWZpeCkge1xuXHRmb3IgKGxldCBrZXkgaW4gc291cmNlKSB7XG5cdFx0aWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBzb3VyY2Vba2V5XSkge1xuXHRcdFx0Ly8gYWRkIGZ1bmN0aW9ucyBhcyBldmVudCBsaXN0ZW5lcnNcblx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihwcmVmaXggKyBrZXksIHNvdXJjZVtrZXldKTtcblx0XHR9IGVsc2UgaWYgKE9iamVjdChzb3VyY2Vba2V5XSkgPT09IHNvdXJjZVtrZXldKSB7XG5cdFx0XHQvLyBhc3NpZ24gb2JqZWN0cyBhcyBzb3VyY2Vcblx0XHRcdF9fYXNzaWduU291cmNlKGVsZW1lbnQsIHNvdXJjZVtrZXldLCBgJHtwcmVmaXggKyBrZXl9LWApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBvdGhlcndpc2UsIHNldCBhdHRyaWJ1dGVzXG5cdFx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZShwcmVmaXggKyBrZXksIHNvdXJjZVtrZXldKTtcblx0XHR9XG5cdH1cbn1cblxuLyogQXNzaWduIGFuIGVsZW1lbnQgd2l0aCBhdHRyaWJ1dGVzLCBldmVudHMsIGFuZCBjaGlsZHJlblxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gJGFzc2lnbihpZCkge1xuXHQvLyAkYXNzaWduKGVsZW1lbnQsIHsgY2xhc3M6ICdidG4nLCBjbGljazogKCkgPT4geyAvKiBsaXN0ZW5lciAqLyB9IH0pO1xuXHQvLyAkYXNzaWduKCdidXR0b24nLCB7IGFyaWE6IHsgbGFiZWw6ICd0aXRsZScgfSB9LCBjaGlsZCk7XG5cdC8vICRhc3NpZ24oJ2RpdicsIGNoaWxkMSwgY2hpbGQyLCAnYSBuZXcgdGV4dCBub2RlJyk7XG5cdC8vICRhc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKSk7XG5cblx0Y29uc3QgZWxlbWVudCA9IGlkIGluc3RhbmNlb2YgTm9kZSA/IGlkIDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChpZCk7XG5cblx0W10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLmZvckVhY2goKHNvdXJjZSkgPT4ge1xuXHRcdGlmIChzb3VyY2UgaW5zdGFuY2VvZiBOb2RlKSB7XG5cdFx0XHQvLyBhcHBlbmQgc291cmNlcyB0aGF0IGFyZSBub2Rlc1xuXHRcdFx0ZWxlbWVudC5hcHBlbmRDaGlsZChzb3VyY2UpO1xuXHRcdH0gZWxzZSBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBzb3VyY2UpIHtcblx0XHRcdC8vIGFwcGVuZCBzdHJpbmdzIGFzIHRleHQgbm9kZXNcblx0XHRcdGVsZW1lbnQuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHNvdXJjZSlcblx0XHRcdCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdF9fYXNzaWduU291cmNlKGVsZW1lbnQsIHNvdXJjZSwgJycpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIGVsZW1lbnQ7XG59XG5cbi8qIFJlcGxhY2UgYWxsIHRoZSBjaGlsZHJlbiBvZiBhIHBhcmVudCBub2RlIHdpdGggbmV3IGNoaWxkcmVuXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiAkcmVwbGFjZUFsbChwYXJlbnROb2RlKSB7XG5cdC8vICRyZXBsYWNlQWxsKGVsZW1lbnQpO1xuXHQvLyAkcmVwbGFjZUFsbChlbGVtZW50LCBjaGlsZDEsIGNoaWxkMik7XG5cblx0d2hpbGUgKHBhcmVudE5vZGUubGFzdENoaWxkKSB7XG5cdFx0cGFyZW50Tm9kZS5yZW1vdmVDaGlsZChwYXJlbnROb2RlLmxhc3RDaGlsZCk7XG5cdH1cblxuXHRwYXJlbnROb2RlLmFwcGVuZENoaWxkKFxuXHRcdF9fYXNGcmFnbWVudChhcmd1bWVudHMpXG5cdCk7XG5cblx0cmV0dXJuIHBhcmVudE5vZGU7XG59XG5cbi8qIFdyYXAgYSBjaGlsZCBub2RlIHdpdGhpbiBhbiBlbGVtZW50XG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiAkd3JhcFdpdGgoY2hpbGROb2RlLCBlbGVtZW50KSB7XG5cdC8vICR3cmFwV2l0aChlbGVtZW50LCB3cmFwcGluZ0VsZW1lbnQpO1xuXG5cdGlmIChjaGlsZE5vZGUucGFyZW50Tm9kZSkge1xuXHRcdGNoaWxkTm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtZW50LCBjaGlsZE5vZGUpLmFwcGVuZENoaWxkKGNoaWxkTm9kZSk7XG5cdH1cblxuXHRyZXR1cm4gY2hpbGROb2RlO1xufVxuXG4vKiBFbWVyZ2luZyBET00gRnVuY3Rpb25hbGl0eVxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gX19hc0ZyYWdtZW50KG5vZGVzKSB7XG5cdGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG5cdFtdLnNsaWNlLmNhbGwobm9kZXMsIDEpLmZvckVhY2goKG5vZGUpID0+IHtcblx0XHRpZiAobm9kZSBpbnN0YW5jZW9mIE5vZGUpIHtcblx0XHRcdGZyYWdtZW50LmFwcGVuZENoaWxkKG5vZGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRmcmFnbWVudC5hcHBlbmRDaGlsZChcblx0XHRcdFx0ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobm9kZSlcblx0XHRcdCk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gZnJhZ21lbnQ7XG59XG5cbi8qIEluc2VydCBub2RlcyBhZnRlciBhIGNoaWxkIG5vZGVcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRhZnRlcihjaGlsZE5vZGUpIHtcblx0Ly8gJGFmdGVyKGVsZW1lbnQsIHNpYmxpbmcxLCBzaWJsaW5nMiwgJ2EgbmV3IHRleHQgbm9kZScpO1xuXG5cdGlmIChjaGlsZE5vZGUucGFyZW50Tm9kZSkge1xuXHRcdGNoaWxkTm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShcblx0XHRcdF9fYXNGcmFnbWVudChhcmd1bWVudHMpLFxuXHRcdFx0Y2hpbGROb2RlLm5leHRTaWJsaW5nXG5cdFx0KTtcblx0fVxuXG5cdHJldHVybiBjaGlsZE5vZGU7XG59XG5cbi8qIEFwcGVuZHMgbm9kZXMgdG8gYSBwYXJlbnQgbm9kZVxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gJGFwcGVuZChwYXJlbnROb2RlKSB7XG5cdC8vICRhcHBlbmQocGFyZW50Tm9kZSwgY2hpbGQxLCBjaGlsZDIsICdhIG5ldyB0ZXh0IG5vZGUnKTtcblxuXHRwYXJlbnROb2RlLmFwcGVuZChcblx0XHRfX2FzRnJhZ21lbnQoYXJndW1lbnRzKVxuXHQpO1xuXG5cdHJldHVybiBwYXJlbnROb2RlO1xufVxuXG4vKiBJbnNlcnQgbm9kZXMgYmVmb3JlIGFuIGVsZW1lbnRcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRiZWZvcmUoZWxlbWVudCkge1xuXHQvLyAkYmVmb3JlKGVsZW1lbnQsIHNpYmxpbmcxLCBzaWJsaW5nMiwgJ2EgbmV3IHRleHQgbm9kZScpO1xuXG5cdGlmIChlbGVtZW50LnBhcmVudE5vZGUpIHtcblx0XHRlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKFxuXHRcdFx0X19hc0ZyYWdtZW50KGFyZ3VtZW50cyksXG5cdFx0XHRlbGVtZW50XG5cdFx0KTtcblx0fVxuXG5cdHJldHVybiBlbGVtZW50O1xufVxuXG4vKiBSZXR1cm4gdGhlIGNsb3Nlc3QgYW5jZXN0b3IgZWxlbWVudCBtYXRjaGluZyBhIGdpdmVuIHNlbGVjdG9yXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiAkY2xvc2VzdChlbGVtZW50LCBzZWxlY3RvcnMpIHtcblx0Ly8gJGNsb3Nlc3QoZWxlbWVudCwgc2VsZWN0b3JzKTtcblxuXHRsZXQgdGFyZ2V0ID0gZWxlbWVudDtcblxuXHR3aGlsZSAodGFyZ2V0ICYmIDEgPT09IHRhcmdldC5ub2RlVHlwZSkge1xuXHRcdGlmICgkbWF0Y2hlcyh0YXJnZXQsIHNlbGVjdG9ycykpIHtcblx0XHRcdHJldHVybiB0YXJnZXQ7XG5cdFx0fVxuXG5cdFx0dGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7XG5cdH1cblxuXHRyZXR1cm4gbnVsbDtcbn1cblxuLyogUmV0dXJuIHdoZXRoZXIgb3Igbm90IGEgRE9NIGVsZW1lbnQgbWF0Y2hlcyBhIGdpdmVuIHNlbGVjdG9yXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiAkbWF0Y2hlcyhlbGVtZW50LCBzZWxlY3RvcnMpIHtcblx0Ly8gJG1hdGNoZXMoZWxlbWVudCwgc2VsZWN0b3JzKTtcblxuXHRjb25zdCBlbGVtZW50cyA9IGVsZW1lbnQucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycyk7XG5cblx0bGV0IGluZGV4ID0gMDtcblxuXHR3aGlsZSAoZWxlbWVudHNbaW5kZXhdICYmIGVsZW1lbnRzW2luZGV4XSAhPT0gZWxlbWVudCkge1xuXHRcdCsraW5kZXg7XG5cdH1cblxuXHRyZXR1cm4gQm9vbGVhbihlbGVtZW50c1tpbmRleF0pO1xufVxuXG4vKiBQcmVwZW5kcyBhIGNoaWxkIHRvIGEgcGFyZW50IG5vZGVcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRwcmVwZW5kKHBhcmVudE5vZGUpIHtcblx0Ly8gJHByZXBlbmQoZWxlbWVudCwgY2hpbGQxLCBjaGlsZDIsICdhIG5ldyB0ZXh0IG5vZGUnKTtcblxuXHRwYXJlbnROb2RlLmluc2VydEJlZm9yZShcblx0XHRfX2FzRnJhZ21lbnQoYXJndW1lbnRzKSxcblx0XHRwYXJlbnROb2RlLmZpcnN0Q2hpbGRcblx0KTtcblxuXHRyZXR1cm4gcGFyZW50Tm9kZTtcbn1cblxuLyogUmVtb3ZlIGEgY2hpbGQgbm9kZSBmcm9tIGl0cyBwYXJlbnRcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRyZW1vdmUoY2hpbGROb2RlKSB7XG5cdC8vICRyZW1vdmUoZWxlbWVudCk7XG5cblx0aWYgKGNoaWxkTm9kZS5wYXJlbnROb2RlKSB7XG5cdFx0Y2hpbGROb2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY2hpbGROb2RlKTtcblx0fVxuXG5cdHJldHVybiBjaGlsZE5vZGU7XG59XG5cbi8qIFJlcGxhY2UgYSBjaGlsZCBub2RlIHdpdGggbm9kZXNcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRyZXBsYWNlV2l0aChjaGlsZE5vZGUpIHtcblx0Ly8gJHJlcGxhY2VXaXRoKGVsZW1lbnQsIHNpYmxpbmcxLCBzaWJsaW5nMiwgJ2EgbmV3IHRleHQgbm9kZScpO1xuXG5cdGlmIChjaGlsZE5vZGUucGFyZW50Tm9kZSkge1xuXHRcdGNoaWxkTm9kZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChcblx0XHRcdF9fYXNGcmFnbWVudChhcmd1bWVudHMpLFxuXHRcdFx0Y2hpbGROb2RlXG5cdFx0KTtcblx0fVxuXG5cdHJldHVybiBjaGlsZE5vZGU7XG59XG5cbi8qIEVtZXJnaW5nIEV2ZW50IEZ1bmN0aW9uYWxpdHlcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbi8qIENyZWF0ZSBhIG5ldyBDdXN0b21FdmVudFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gJEN1c3RvbUV2ZW50KHR5cGUpIHtcblx0Ly8gZWxlbWVudC5kaXNwYXRjaEV2ZW50KG5ldyAkQ3VzdG9tRXZlbnQoJ2NsaWNrJywgeyBidWJibGVzOiB0cnVlIH0pKTtcblxuXHRjb25zdCBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuXHRjb25zdCBwYXJhbSA9IE9iamVjdChhcmd1bWVudHNbMV0pIHx8IHsgYnViYmxlczogZmFsc2UsIGNhbmNlbGFibGU6IGZhbHNlLCBkZXRhaWw6IHVuZGVmaW5lZCB9O1xuXG5cdGV2ZW50LmluaXRDdXN0b21FdmVudCh0eXBlLCBwYXJhbS5idWJibGVzLCBwYXJhbS5jYW5jZWxhYmxlLCBwYXJhbS5kZXRhaWwpO1xuXG5cdHJldHVybiBldmVudDtcbn1cblxuLyogRmV0Y2ggcmVzcG9uc2UgdGV4dCBmcm9tIGEgVVJMIGFuZCBwYXNzIGl0IHRvIGEgY2FsbGJhY2tcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRmZXRjaCh1cmwsIGNhbGxiYWNrKSB7XG5cdC8vICRmZXRjaCgnYXBpP2Zvbz1iYXInLCAocmVzcG9uc2VUZXh0KSA9PiB7fSk7XG5cblx0Y29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cblx0eGhyLmFkZEV2ZW50TGlzdGVuZXIoJ3JlYWR5c3RhdGVjaGFuZ2UnLCAoKSA9PiB7XG5cdFx0aWYgKDQgPT09IHhoci5yZWFkeVN0YXRlICYmIDIwMCA9PT0geGhyLnN0YXR1cykge1xuXHRcdFx0Y2FsbGJhY2soeGhyLnJlc3BvbnNlVGV4dCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY2FsbGJhY2stcmV0dXJuXG5cdFx0fVxuXHR9KTtcblxuXHR4aHIub3BlbignR0VUJywgdXJsKTtcblx0eGhyLnNlbmQoKTtcblxuXHRyZXR1cm4geGhyO1xufVxuXG4vKiBFeHBvcnRcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmV4cG9ydCB7XG5cdCRhc3NpZ24sXG5cdCRhZnRlcixcblx0JGFwcGVuZCxcblx0JGJlZm9yZSxcblx0JGNsb3Nlc3QsXG5cdCRDdXN0b21FdmVudCxcblx0JGZldGNoLFxuXHQkbWF0Y2hlcyxcblx0JHByZXBlbmQsXG5cdCRyZW1vdmUsXG5cdCRyZXBsYWNlQWxsLFxuXHQkcmVwbGFjZVdpdGgsXG5cdCR3cmFwV2l0aFxufTtcbiIsIi8qIEVzcmkgU2VhcmNoIEZvcm0sIENvcHlyaWdodCAyMDE3IEVzcmlcblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZSBkaXN0cmlidXRlZFxudW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1JcbkNPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbnVuZGVyIHRoZSBMaWNlbnNlLiAqL1xuXG5pbXBvcnQgeyAkYXNzaWduIGFzICQsICRDdXN0b21FdmVudCB9IGZyb20gJ2RvbW9zZSc7XG5cbi8qIFNlYXJjaFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZXhwb3J0IGRlZmF1bHQgKGRhdGEpID0+IHtcblx0LyogRWxlbWVudHNcblx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdGNvbnN0ICRsYWJlbCA9ICQoJ2xhYmVsJywge1xuXHRcdGNsYXNzOiBgJHtkYXRhLnByZWZpeH0tbGFiZWxgLFxuXHRcdGZvcjogYCR7ZGF0YS5wcmVmaXh9LXF1ZXJ5LWNvbnRyb2xgXG5cdH0sIGRhdGEucXVlcnlMYWJlbCk7XG5cblx0Y29uc3QgJGNvbnRyb2wgPSAkKCdpbnB1dCcsIHtcblx0XHRjbGFzczogYCR7ZGF0YS5wcmVmaXh9LWNvbnRyb2xgLCBpZDogYCR7ZGF0YS5wcmVmaXh9LWNvbnRyb2xgLFxuXHRcdHR5cGU6ICdzZWFyY2gnLCBuYW1lOiAncScsXG5cdFx0YXV0b2NhcGl0YWxpemU6ICdvZmYnLCBhdXRvY29tcGxldGU6ICdvZmYnLCBhdXRvY29ycmVjdDogJ29mZicsIHNwZWxsY2hlY2s6ICdmYWxzZSdcblx0fSk7XG5cblx0Y29uc3QgJG1lYXN1cmVUZXh0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTtcblxuXHRjb25zdCAkbWVhc3VyZVRleHQgPSAkKCdkaXYnLCB7XG5cdFx0Y2xhc3M6IGAke2RhdGEucHJlZml4fS1tZWFzdXJlLXRleHRgLFxuXHRcdGFyaWE6IHsgaGlkZGVuOiB0cnVlIH1cblx0fSwgJG1lYXN1cmVUZXh0Tm9kZSk7XG5cblx0Y29uc3QgJG1lYXN1cmUgPSAkKCdkaXYnLCB7IGNsYXNzOiBgJHtkYXRhLnByZWZpeH0tbWVhc3VyZWAgfSwgJG1lYXN1cmVUZXh0KTtcblxuXHRjb25zdCAkc3VibWl0ID0gJCgnYnV0dG9uJywge1xuXHRcdGNsYXNzOiBgJHtkYXRhLnByZWZpeH0tc3VibWl0YCwgdHlwZTogJ3N1Ym1pdCcsXG5cdFx0YXJpYTogeyBsYWJlbDogZGF0YS5zdWJtaXRMYWJlbCB9XG5cdH0pO1xuXG5cdGNvbnN0ICRzZWFyY2ggPSAkKCdmb3JtJywge1xuXHRcdGNsYXNzOiBgJHtkYXRhLnByZWZpeH0tZm9ybWAsIGFjdGlvbjogZGF0YS5hY3Rpb24sXG5cdFx0cm9sZTogJ3NlYXJjaCcsIGFyaWE6IHsgbGFiZWw6IGRhdGEubGFiZWwgfVxuXHR9LCAkbGFiZWwsICRjb250cm9sLCAkbWVhc3VyZSwgJHN1Ym1pdCk7XG5cblx0LyogRm9jdXMgRXZlbnRcblx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdCRzZWFyY2guYWRkRXZlbnRMaXN0ZW5lcihgJHtkYXRhLnByZWZpeH06Zm9jdXNgLCAoKSA9PiB7XG5cdFx0JGNvbnRyb2wuZm9jdXMoKTtcblx0fSk7XG5cblx0LyogT24gSW5wdXRcblx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdGxldCBjb250cm9sSXNGaWxsZWQgPSBmYWxzZTtcblx0bGV0IGNvbnRyb2xWYWx1ZSA9ICcnO1xuXG5cdGZ1bmN0aW9uIG9uaW5wdXQoZXZlbnQpIHtcblx0XHQvKiBDb25kaXRpb25hbGx5IFJlc2V0IENvbnRyb2wgVmFsdWVcblx0XHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRcdGlmIChldmVudCAmJiAncmVzZXQnID09PSBldmVudC50eXBlKSB7XG5cdFx0XHQkY29udHJvbC52YWx1ZSA9ICcnO1xuXHRcdH1cblxuXHRcdC8qIFVwZGF0ZSBOZXcgQ29udHJvbCBWYWx1ZVxuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdFx0Y29uc3QgbmV3Q29udHJvbFZhbHVlID0gJGNvbnRyb2wudmFsdWUudHJpbSgpO1xuXG5cdFx0aWYgKG5ld0NvbnRyb2xWYWx1ZSAhPT0gY29udHJvbFZhbHVlKSB7XG5cdFx0XHRjb250cm9sVmFsdWUgPSBuZXdDb250cm9sVmFsdWU7XG5cblx0XHRcdCRkaXNwYXRjaCgkc2VhcmNoLCBgJHtkYXRhLnByZWZpeH06aW5wdXRgLCB7XG5cdFx0XHRcdHZhbHVlOiBjb250cm9sVmFsdWUsXG5cdFx0XHRcdGV2ZW50XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvKiBVcGRhdGUgTGFiZWwgYW5kIFN1Ym1pdCBVSVxuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdFx0aWYgKGNvbnRyb2xJc0ZpbGxlZCAmJiAhbmV3Q29udHJvbFZhbHVlKSB7XG5cdFx0XHRjb250cm9sSXNGaWxsZWQgPSBmYWxzZTtcblxuXHRcdFx0JGxhYmVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1maWxsZWQnKTtcblx0XHRcdCRzdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWZpbGxlZCcpO1xuXHRcdH0gZWxzZSBpZiAoIWNvbnRyb2xJc0ZpbGxlZCAmJiBuZXdDb250cm9sVmFsdWUpIHtcblx0XHRcdGNvbnRyb2xJc0ZpbGxlZCA9IHRydWU7XG5cblx0XHRcdCQoJGxhYmVsLCB7IGRhdGE6IHsgZmlsbGVkOiAnJyB9IH0pO1xuXHRcdFx0JCgkc3VibWl0LCB7IGRhdGE6IHsgZmlsbGVkOiAnJyB9IH0pO1xuXHRcdH1cblxuXHRcdC8qIFVwZGF0ZSBNZWFzdXJlIFVJXG5cdFx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0XHQkbWVhc3VyZVRleHROb2RlLm5vZGVWYWx1ZSA9IG5ld0NvbnRyb2xWYWx1ZTtcblxuXHRcdGNvbnN0IGN1cnJlbnRXaWR0aCA9IGAkeyRtZWFzdXJlVGV4dC5zY3JvbGxXaWR0aH1weGA7XG5cblx0XHQkbWVhc3VyZS5zdHlsZS53aWR0aCA9IGN1cnJlbnRXaWR0aDtcblx0fVxuXG5cdC8qIE9uIFN1Ym1pdFxuXHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0ZnVuY3Rpb24gb25zdWJtaXQoZXZlbnQpIHtcblx0XHQkZGlzcGF0Y2goJHNlYXJjaCwgYCR7ZGF0YS5wcmVmaXh9OnN1Ym1pdGAsIHtcblx0XHRcdHZhbHVlOiAkY29udHJvbC52YWx1ZSxcblx0XHRcdGV2ZW50XG5cdFx0fSk7XG5cdH1cblxuXHQvKiBPbiBET01Ob2RlSW5zZXJ0ZWRcblx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdCRzZWFyY2guYWRkRXZlbnRMaXN0ZW5lcignRE9NTm9kZUluc2VydGVkJywgZnVuY3Rpb24gb25ET01Ob2RlSW5zZXJ0ZWQoKSB7XG5cdFx0Ly8gSWYgU2VhcmNoIG5vdyBoYXMgYSBwYXJlbnQgbm9kZVxuXHRcdGlmICgkc2VhcmNoLnBhcmVudE5vZGUpIHtcblx0XHRcdC8vIFVuYmluZCB0aGUgRE9NTm9kZUluc2VydGVkIG1ldGhvZFxuXHRcdFx0JHNlYXJjaC5yZW1vdmVFdmVudExpc3RlbmVyKCdET01Ob2RlSW5zZXJ0ZWQnLCBvbkRPTU5vZGVJbnNlcnRlZCk7XG5cblx0XHRcdC8vIFVwZGF0ZSBTZWFyY2hcblx0XHRcdCRkaXNwYXRjaCgkc2VhcmNoLCBgJHtkYXRhLnByZWZpeH06dXBkYXRlYCwgZGF0YSk7XG5cdFx0fVxuXHR9KTtcblxuXHQvKiBPbiBVcGRhdGVcblx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdCRzZWFyY2guYWRkRXZlbnRMaXN0ZW5lcihgJHtkYXRhLnByZWZpeH06dXBkYXRlYCwgKCkgPT4ge1xuXHRcdC8qIEJpbmQgTWVkaWEgRXZlbnRcblx0XHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0XHRjb25zdCBtZWRpYSA9ICRzZWFyY2gub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5tYXRjaE1lZGlhKGRhdGEubWF0Y2hNZWRpYSB8fCAnKG1heC13aWR0aDogNzIwcHgpJyk7XG5cblx0XHRtZWRpYS5hZGRMaXN0ZW5lcihvbmlucHV0KTtcblxuXHRcdC8qIEJpbmQgT3RoZXIgRXZlbnRzXG5cdFx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0XHQkY29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uaW5wdXQpO1xuXG5cdFx0JHNlYXJjaC5hZGRFdmVudExpc3RlbmVyKCdyZXNldCcsIG9uaW5wdXQpO1xuXHRcdCRzZWFyY2guYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgb25zdWJtaXQpO1xuXHRcdCRzZWFyY2guYWRkRXZlbnRMaXN0ZW5lcihgJHtkYXRhLnByZWZpeH06dW5sb2FkYCwgb251bmxvYWQpO1xuXHR9KTtcblxuXHRyZXR1cm4gJHNlYXJjaDtcbn07XG5cbi8qIERpc3BhdGNoIEhlbHBlclxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gJGRpc3BhdGNoKHRhcmdldCwgdHlwZSwgZGV0YWlsKSB7XG5cdHRhcmdldC5kaXNwYXRjaEV2ZW50KCRDdXN0b21FdmVudCh0eXBlLCB7IGJ1YmJsZXM6IHRydWUsIGRldGFpbCB9KSk7XG59XG4iXSwibmFtZXMiOlsiX19hc3NpZ25Tb3VyY2UiLCJlbGVtZW50Iiwic291cmNlIiwicHJlZml4Iiwia2V5IiwiYWRkRXZlbnRMaXN0ZW5lciIsIk9iamVjdCIsInNldEF0dHJpYnV0ZSIsIiRhc3NpZ24iLCJpZCIsIk5vZGUiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzbGljZSIsImNhbGwiLCJhcmd1bWVudHMiLCJmb3JFYWNoIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsIiRDdXN0b21FdmVudCIsInR5cGUiLCJldmVudCIsImNyZWF0ZUV2ZW50IiwicGFyYW0iLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImRldGFpbCIsInVuZGVmaW5lZCIsImluaXRDdXN0b21FdmVudCIsIiRkaXNwYXRjaCIsInRhcmdldCIsImRpc3BhdGNoRXZlbnQiLCJkYXRhIiwib25pbnB1dCIsInZhbHVlIiwibmV3Q29udHJvbFZhbHVlIiwiJGNvbnRyb2wiLCJ0cmltIiwiY29udHJvbFZhbHVlIiwiJHNlYXJjaCIsImNvbnRyb2xJc0ZpbGxlZCIsInJlbW92ZUF0dHJpYnV0ZSIsIiRsYWJlbCIsImZpbGxlZCIsIiRzdWJtaXQiLCJub2RlVmFsdWUiLCJjdXJyZW50V2lkdGgiLCIkbWVhc3VyZVRleHQiLCJzY3JvbGxXaWR0aCIsInN0eWxlIiwid2lkdGgiLCJvbnN1Ym1pdCIsIiQiLCJxdWVyeUxhYmVsIiwibmFtZSIsImF1dG9jb21wbGV0ZSIsImF1dG9jb3JyZWN0Iiwic3BlbGxjaGVjayIsIiRtZWFzdXJlVGV4dE5vZGUiLCJoaWRkZW4iLCIkbWVhc3VyZSIsImNsYXNzIiwibGFiZWwiLCJzdWJtaXRMYWJlbCIsImFjdGlvbiIsImFyaWEiLCJmb2N1cyIsIm9uRE9NTm9kZUluc2VydGVkIiwicGFyZW50Tm9kZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJvd25lckRvY3VtZW50IiwiZGVmYXVsdFZpZXciLCJtYXRjaE1lZGlhIiwiYWRkTGlzdGVuZXIiLCJvbnVubG9hZCJdLCJtYXBw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"}